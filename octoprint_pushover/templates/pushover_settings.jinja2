<h3>{{ _('Pushover Configuration') }}</h3>

<div class="alert" data-bind="visible: !has_own_token()">
    <p>
        {{ _('The default API token can not be used with some notification functionality, obtain your own API key and enter it below too make the most out of this plugin.') }}
    </p>
</div>

{% trans %}<p>
    In order to use the Pushover plugin enter your user key below. You can find your user key in
    <a href="https://pushover.net/" target="_blank">your Pushover account settings</a>.
</p>{% endtrans %}

<form class="form-horizontal">
    <h4>{{ _('General') }}</h4>

    <div class="control-group">
        <label class="control-label">{{ _('API Key') }}</label>
        <div class="controls">
            <div class="row-fluid" style="margin-bottom: 5px">
                <div class="span8">
                    <input type="text" class="input-block-level" id="apikey" data-bind="value: settings.plugins.pushover.token">
                </div>

                <div class="span4">
                    <a href="https://pushover.net/apps/clone/octoprint" target="_blank"  class="btn">
                    <svg  width="15px" height="15px" viewBox="57 57 602 602" version="1.1" xmlns="http://www.w3.org/2000/svg" style="float: left; margin-top: 3px;">
                      <g id="layer1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(58.964119, 58.887520)" opacity="0.91">
                        <ellipse style="fill: rgb(36, 157, 241); fill-rule: evenodd; stroke: rgb(255, 255, 255); stroke-width: 0;" transform="matrix(-0.674571, 0.73821, -0.73821, -0.674571, 556.833239, 241.613465)" cx="216.308" cy="152.076" rx="296.855" ry="296.855"/>
                        <path d="M 280.949 172.514 L 355.429 162.714 L 282.909 326.374 L 282.909 326.374 C 295.649 325.394 308.142 321.067 320.389 313.394 L 320.389 313.394 L 320.389 313.394 C 332.642 305.714 343.916 296.077 354.209 284.484 L 354.209 284.484 L 354.209 284.484 C 364.496 272.884 373.396 259.981 380.909 245.774 L 380.909 245.774 L 380.909 245.774 C 388.422 231.561 393.812 217.594 397.079 203.874 L 397.079 203.874 L 397.079 203.874 C 399.039 195.381 399.939 187.214 399.779 179.374 L 399.779 179.374 L 399.779 179.374 C 399.612 171.534 397.569 164.674 393.649 158.794 L 393.649 158.794 L 393.649 158.794 C 389.729 152.914 383.766 148.177 375.759 144.584 L 375.759 144.584 L 375.759 144.584 C 367.759 140.991 356.899 139.194 343.179 139.194 L 343.179 139.194 L 343.179 139.194 C 327.172 139.194 311.409 141.807 295.889 147.034 L 295.889 147.034 L 295.889 147.034 C 280.376 152.261 266.002 159.857 252.769 169.824 L 252.769 169.824 L 252.769 169.824 C 239.542 179.784 228.029 192.197 218.229 207.064 L 218.229 207.064 L 218.229 207.064 C 208.429 221.924 201.406 238.827 197.159 257.774 L 197.159 257.774 L 197.159 257.774 C 195.526 263.981 194.546 268.961 194.219 272.714 L 194.219 272.714 L 194.219 272.714 C 193.892 276.474 193.812 279.577 193.979 282.024 L 193.979 282.024 L 193.979 282.024 C 194.139 284.477 194.462 286.357 194.949 287.664 L 194.949 287.664 L 194.949 287.664 C 195.442 288.971 195.852 290.277 196.179 291.584 L 196.179 291.584 L 196.179 291.584 C 179.519 291.584 167.349 288.234 159.669 281.534 L 159.669 281.534 L 159.669 281.534 C 151.996 274.841 150.119 263.164 154.039 246.504 L 154.039 246.504 L 154.039 246.504 C 157.959 229.191 166.862 212.694 180.749 197.014 L 180.749 197.014 L 180.749 197.014 C 194.629 181.334 211.122 167.531 230.229 155.604 L 230.229 155.604 L 230.229 155.604 C 249.342 143.684 270.249 134.214 292.949 127.194 L 292.949 127.194 L 292.949 127.194 C 315.656 120.167 337.789 116.654 359.349 116.654 L 359.349 116.654 L 359.349 116.654 C 378.296 116.654 394.219 119.347 407.119 124.734 L 407.119 124.734 L 407.119 124.734 C 420.026 130.127 430.072 137.234 437.259 146.054 L 437.259 146.054 L 437.259 146.054 C 444.446 154.874 448.936 165.164 450.729 176.924 L 450.729 176.924 L 450.729 176.924 C 452.529 188.684 451.959 200.934 449.019 213.674 L 449.019 213.674 L 449.019 213.674 C 445.426 229.027 438.646 244.464 428.679 259.984 L 428.679 259.984 L 428.679 259.984 C 418.719 275.497 406.226 289.544 391.199 302.124 L 391.199 302.124 L 391.199 302.124 C 376.172 314.697 358.939 324.904 339.499 332.744 L 339.499 332.744 L 339.499 332.744 C 320.066 340.584 299.406 344.504 277.519 344.504 L 277.519 344.504 L 275.069 344.504 L 212.839 484.154 L 142.279 484.154 L 280.949 172.514 Z" transform="matrix(1, 0, 0, 1, 0, 0)" style="fill: rgb(255, 255, 255); fill-rule: nonzero; white-space: pre;"/>
                      </g>
                    </svg>
                    <span style="margin-left: 5px">{{ _('Obtain API key') }}</span></a>
                </div>
            </div>
            <span class="help-inline">{{ _('Use your own API Key, this is not necessary for this plugin to work. But definitely ensures it will always works') }}</span>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">{{ _('User Key') }}</label>
        <div class="controls">
            <input type="text" class="input-block-level" id="userkey" data-bind="value: settings.plugins.pushover.user_key">
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">{{ _('Devices') }}</label>
        <div class="controls">
            <input type="text" class="input-block-level" id="device" data-bind="value: settings.plugins.pushover.device">
            <span class="help-inline">{{ _('Enter the name of your device name to send the message directly to that device, rather than all of your devices (multiple devices may be separated by a comma). Or leave empty for all devices.') }}</span>
        </div>
    </div>

    <div class="control-group">
        <div class="controls">
            <button class="btn" data-bind="click: function() { testNotification() }"><i class="icon-spinner icon-spin" data-bind="visible: testActive()"></i> {{ _('Test Pushover') }}</button> <span data-bind="visible: testResult() && testSuccessful()">{{ _('Sent successfully') }}</span><span data-bind="visible: testResult() && !testSuccessful()">{{ _('Sending failed') }}: <span data-bind="text: testMessage"></span></span>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">{{ _('Sound') }}</label>
        <div class="controls">
            <select id="pushover-sound" data-bind="value: settings.plugins.pushover.sound">
                {% for item in plugin_pushover_sounds -%}
                    <option value="{{ item }}">{{ item }}</option>
                {%- endfor %}
            </select>
        </div>
    </div>

    <h4>{{ _('Webcam') }}</h4>

    <div class="control-group">
        <div class="controls">
            <label class="checkbox">
                <input type="checkbox" data-bind="checked: settings.plugins.pushover.image" id="image"> {{ _('Use the camera of Octoprint to send a image') }}
            </label>
        </div>

        <div class="controls">
            <label class="control-label">{{ _('Lighting Pin') }}</label>
            <div class="controls">
                <input type="text" class="input-block-level" id="lighting_pin" data-bind="value: settings.plugins.pushover.lighting_pin">
                {{ _('GPIO pin to turn on before taking picture (will turn on light briefly for webcam to take picture)') }}
            </div>
        </div>

        <div class="controls">
            <label class="checkbox">
                <input type="checkbox" data-bind="checked: settings.plugins.pushover.lighting_pin_low" id="lighting_pin_low"> {{ _('Active low means that the GPIO will turn on when receive a low signal (ground) from Raspberry PI') }}
            </label>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">{{ _('Server Url') }}</label>
        <div class="controls">
            <input type="text" class="input-block-level" id="url" data-bind="value: settings.plugins.pushover.url">
            <span class="help-inline">{{ _('Displayed below the notification. Enter a valid url (e.g: https://www.myserver.de/octoprint) or leave it empty to use the defaul machine name.') }}</span>
        </div>
    </div>

    <h4>{{ _('Scheduled notifications') }}</h4>

    <div class="control-group">
        <label class="control-label">{{ _('Notify me (minutes)') }}</label>
        <div class="controls">
            <select data-bind="value: settings.plugins.pushover.events.Scheduled.mod, enable: has_own_token()">
                <option value="">{{ _('Off') }}</option>
                <option value="2">{{ _('Every 2 minutes') }}</option>
                <option value="5">{{ _('Every 5 minutes') }}</option>
                <option value="10">{{ _('Every 10 minutes') }}</option>
                <option value="20">{{ _('Every 20 minutes') }}</option>
                <option value="30">{{ _('Every 30 minutes') }}</option>
                <option value="40">{{ _('Every 40 minutes') }}</option>
                <option value="50">{{ _('Every 50 minutes') }}</option>
                <option value="60">{{ _('Every hour') }}</option>
            </select>
            <span class="help-inline">{{ _('Send regular updates every y minutes.') }}</span>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">{{ _('Notify me (percent)') }}</label>
        <div class="controls">
            <select data-bind="value: settings.plugins.pushover.events.Progress.mod, enable: has_own_token()">
                <option value="">{{ _('Off') }}</option>
                <option value="2">{{ _('Every 2 percent') }}</option>
                <option value="5">{{ _('Every 5 percent') }}</option>
                <option value="10">{{ _('Every 10 percent') }}</option>
                <option value="15">{{ _('Every 15 percent') }}</option>
                <option value="20">{{ _('Every 20 percent') }}</option>
                <option value="25">{{ _('Every 25 percent') }}</option>
            </select>
            <span class="help-inline">{{ _('Send regular updates every y percent.') }}</span>
        </div>
    </div>

    <h4>{{ _('Event notifications') }}</h4>

    {% for key, value in plugin_pushover_events.iteritems() if not value.hidden and not value.custom %}
       <div class="control-group">
            <label class="control-label">{{ value.name }}</label>
            <div class="controls">
                <select data-bind="value: settings.plugins.pushover.events.{{ key }}.priority, disable: settings.plugins.pushover.events.{{ key }}.token_required && !has_own_token()">
                    <option value="">{{ _('Off') }}</option>
                    <option value="-2">{{ _('Lowest Priority') }}</option>
                    <option value="-1">{{ _('Low Priority') }}</option>
                    <option value="0">{{ _('Normal Priority') }}</option>
                    <option value="1">{{ _('High Priority') }}</option>
                </select>
                {% if value.help is defined %}
                    <span class="help-inline">{{ value.help }}</span>
                {% endif %}
            </div>
        </div>
    {% endfor %}

    <div>
        <div><small><a href="#" class="muted" onclick="$(this).children().toggleClass('icon-caret-right icon-caret-down').parent().parent().parent().next().slideToggle('fast')"><i class="icon-caret-right"></i> {{ _('Advanced options') }}</a></small></div>
        <div class="hide">

            {% for key, value in plugin_pushover_events.iteritems() if value.hidden and not value.custom %}
            <div class="control-group">
                <label class="control-label">{{ value.name }}</label>
                <div class="controls">
                    <select data-bind="value: settings.plugins.pushover.events.{{ key }}.priority">
                        <option value="">{{ _('Off') }}</option>
                        <option value="-2">{{ _('Lowest Priority') }}</option>
                        <option value="-1">{{ _('Low Priority') }}</option>
                        <option value="0">{{ _('Normal Priority') }}</option>
                        <option value="1">{{ _('High Priority') }}</option>
                    </select>
                    {% if value.help is defined %}
                        <span class="help-inline">{{ value.help }}</span>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
        </div>
    </div>
</form>
